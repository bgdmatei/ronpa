<div class="container pl-0 pr-0">
  <div id="debate-box">
    <h1 class="text-center topic-proposition-text"><%= @debate.topic.proposition%></h1>
    <div class="d-flex justify-content-around">
      <h3 class="role text-center">Affirmative position</h3>
      <h3 class="role text-center">Negative position</h3>
    </div>
    <div class="row justify-content-center">
      <div class="phase-text">
        <h4><%= render 'debate_phase', debate: @debate%></h4>
        <h4 class="text-center text-clock"><%= render 'shared/timer' %></h4>
      </div>
    </div>
    <div class="d-flex justify-content-around pb-4">
      <% if @debate.participants.affirmative.any? %>
        <%= render 'user_info', participant: @debate.participants.affirmative.first%>
      <% elsif @debate.participants.negative.any? %>
        <%= render 'user_info', participant: @debate.participants.negative.first%>
      <% end %>
    </div>

    <div class="d-flex justify-content-around">
      <% @debate.participants.each do |participant| %>
          <% if participant.affirmative? %>
            <div>
              <div class="user-pane-left">
                <%= render 'user_pane_left', participant: participant %>
              </div>
              <div class="text-center mt-4">
                <% if participant.user == current_user && @debate.affirmative_turn? %>
                  <%= link_to "End Turn", debate_next_phase_path(@debate), method: :patch, class: "hvr-outline-in"  %>
                <% end %>
              </div>
            </div>
          <% elsif participant.negative? %>
            <div>
              <div class="user-pane-right">
                <%= render 'user_pane_right', participant: participant %>
              </div>
              <div class="text-center mt-4">
                <% if participant.user == current_user && @debate.negative_turn? %>
                  <%= link_to "End Turn", debate_next_phase_path(@debate), method: :patch, class: "hvr-outline-in"  %>
                <% end %>
              </div>
            </div>
          <% end %>
      <% end %>
    </div>

    <div>
      <div class="text-center text-moderator">
        <% if @debate.moderator %>
          <%= cl_image_tag @debate.moderator.photo, class:"text-center moderator-image" %>
          <h4><%= @debate.moderator.username %> is moderating</h4>
          <%= link_to "End Turn", debate_next_phase_path(@debate), method: :patch, class: "btn-new"  %>
            <% if @debate.waiting_end? %>
              <%= link_to "Affirmative Wins", debate_set_result_path(@debate, winner_id: @debate.participants.affirmative.first), method: :patch, class: "btn-new"  %>
              <%= link_to "Negative Wins", debate_set_result_path(@debate, winner_id: @debate.participants.negative.first), method: :patch, class: "btn-new"  %>
            <% end %>
          <% end %>
      </div>
    </div>
  </div>
</div>

